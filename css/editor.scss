/**
 * Editor-only styles for the Motion Blocks plugin.
 *
 * Uses @scope for clean specificity over Emotion CSS-in-JS,
 * and WPDS tokens from @wordpress/base-styles.
 */

@use "@wordpress/base-styles/colors" as colors;
@use "@wordpress/base-styles/variables" as vars;
@use "@wordpress/base-styles/mixins" as mix;

// Mode selector — initial state before animation is configured
@scope (.mb-mode-selector) {
	:scope {
		display: flex;
		flex-direction: column;
	}

	.mb-mode-selector__header {
		display: flex;
		align-items: center;
		gap: vars.$grid-unit-05;
		margin-bottom: vars.$grid-unit-10;
	}

	.mb-mode-selector__label {
		flex: 1;
		font-size: 11px;
		font-weight: 500;
		text-transform: uppercase;
		color: colors.$gray-900;
	}

	.mb-mode-selector__cards {
		display: flex;
		flex-direction: column;
	}

	.mb-mode-card {
		display: flex;
		flex-direction: column;
		gap: vars.$grid-unit-05;
		padding: vars.$grid-unit-15;
		border: 1px solid colors.$gray-400;
		background: none;
		text-align: left;
		cursor: pointer;
		width: 100%;
		font-family: inherit;

		// Collapse borders between adjacent cards
		& + & {
			border-top: none;
		}

		&:hover {
			background: colors.$gray-100;
		}

		&:focus-visible {
			outline: 1.5px solid var(--wp-admin-theme-color, #3858e9);
			outline-offset: -1.5px;
		}
	}

	.mb-mode-card__header {
		display: flex;
		align-items: center;
		gap: vars.$grid-unit-10;
		min-height: 24px;
	}

	.mb-mode-card__title {
		flex: 1;
		font-size: 13px;
		font-weight: 500;
		color: colors.$gray-900;
		line-height: 20px;
	}

	.mb-mode-card__description {
		font-size: 12px;
		font-weight: 400;
		color: colors.$gray-700;
		line-height: 16px;
		margin: 0;
	}
}

// Sub-panel (shared by all three animation modes)
@scope (.mb-sub-panel) {
	:scope {
		display: flex;
		flex-direction: column;
	}

	.mb-sub-panel-header {
		display: flex;
		flex-direction: column;
		gap: vars.$grid-unit-10;
		padding-bottom: vars.$grid-unit-20;
		margin-bottom: vars.$grid-unit-20;
		border-bottom: 1px solid colors.$gray-400;
	}

	.mb-sub-panel-title-row {
		display: flex;
		align-items: center;
		gap: vars.$grid-unit-05;
	}

	.mb-sub-panel-title {
		flex: 1;
		font-size: 13px;
		font-weight: 500;
		color: colors.$gray-900;
		line-height: 20px;
		margin: 0;
		padding: 0;
	}

	.mb-help-text {
		font-size: 12px;
		font-weight: 400;
		color: colors.$gray-700;
		line-height: 16px;
		margin: 0;
	}

	.mb-select-row {
		display: flex;
		align-items: flex-end;
		gap: vars.$grid-unit-15;
		margin-bottom: vars.$grid-unit-20;

		// Nested to bump specificity above Emotion CSS-in-JS.
		.components-select-control {
			flex: 1;
			min-width: 0;
			margin-bottom: 0;
		}
	}

	.mb-remove-button {
		width: 100%;
		justify-content: center;
		margin-top: vars.$grid-unit-10;
	}
}

// Preview keyframes — applied via className on the block element.
// Direction is parameterized via CSS custom properties set as inline
// styles by the withAnimationPreview HOC.

// DEBUG: Scroll-progress border — green = animating, red = complete. Remove when done.
@keyframes mbDebugScroll {
	0%    { outline: 3px solid lime; outline-offset: -3px; }
	99.9% { outline: 3px solid lime; outline-offset: -3px; }
	100%  { outline: 3px solid red;  outline-offset: -3px; }
}

// Entrance
@keyframes mbFadeIn { from { opacity: 0; } to { opacity: 1; } }
@keyframes mbSlideIn { from { opacity: 0; transform: translate(var(--mb-slide-x, 0), var(--mb-slide-y, 30px)); } to { opacity: 1; transform: translate(0, 0); } }
@keyframes mbWipeIn { from { clip-path: var(--mb-wipe-from, inset(0 100% 0 0)); } to { clip-path: inset(0 0 0 0); } }
@keyframes mbCurtainReveal { from { clip-path: var(--mb-curtain-from, inset(0 50% 0 50%)); } to { clip-path: inset(0 0 0 0); } }
@keyframes mbFlipIn { from { opacity: 0; transform: perspective(800px) var(--mb-flip-transform, rotateY(90deg)); } to { opacity: 1; transform: perspective(800px) rotateY(0deg) rotateX(0deg); } }
@keyframes mbScaleIn { from { opacity: 0; transform: scale(0.75) translate(var(--mb-scale-x, 0), var(--mb-scale-y, 0)); } to { opacity: 1; transform: scale(1) translate(0, 0); } }
@keyframes mbBlurIn { from { opacity: 0; filter: blur(var(--mb-blur-amount, 8px)); } to { opacity: 1; filter: blur(0px); } }

// Exit
@keyframes mbFadeOut { from { opacity: 1; } to { opacity: 0; } }
@keyframes mbSlideOut { from { opacity: 1; transform: translate(0, 0); } to { opacity: 0; transform: translate(var(--mb-slide-x, 0), var(--mb-slide-y, 30px)); } }
@keyframes mbWipeOut { from { clip-path: inset(0 0 0 0); } to { clip-path: var(--mb-wipe-from, inset(0 100% 0 0)); } }
@keyframes mbCurtainClose { from { clip-path: inset(0 0 0 0); } to { clip-path: var(--mb-curtain-from, inset(0 50% 0 50%)); } }
@keyframes mbScaleOut { from { opacity: 1; transform: scale(1) translate(0, 0); } to { opacity: 0; transform: scale(0.75) translate(var(--mb-scale-x, 0), var(--mb-scale-y, 0)); } }
@keyframes mbBlurOut { from { opacity: 1; filter: blur(0px); } to { opacity: 0; filter: blur(var(--mb-blur-amount, 8px)); } }

// Connect animation classes to keyframes for editor preview.
// CSS custom properties come from inline styles set by the
// withAnimationPreview HOC so the preview respects user settings.
.mb-preview {
	animation-duration: var(--mb-duration, 0.6s);
	animation-timing-function: var(--mb-timing, ease);
	animation-delay: var(--mb-delay, 0s);
	animation-fill-mode: var(--mb-fill-mode, both);
	animation-iteration-count: var(--mb-iteration-count, 1);
	animation-direction: var(--mb-direction, normal);

	// Entrance animations
	&.mb-animate-enter-fade { animation-name: mbFadeIn; }
	&.mb-animate-enter-slide { animation-name: mbSlideIn; }
	&.mb-animate-enter-wipe { animation-name: mbWipeIn; }
	&.mb-animate-enter-curtain { animation-name: mbCurtainReveal; }
	&.mb-animate-enter-flip {
		animation-name: mbFlipIn;
		backface-visibility: hidden;
		transform-style: preserve-3d;
	}
	&.mb-animate-enter-scale { animation-name: mbScaleIn; }
	&.mb-animate-enter-blur { animation-name: mbBlurIn; }

	// Exit animations
	&.mb-animate-exit-fade { animation-name: mbFadeOut; }
	&.mb-animate-exit-slide { animation-name: mbSlideOut; }
	&.mb-animate-exit-wipe { animation-name: mbWipeOut; }
	&.mb-animate-exit-curtain { animation-name: mbCurtainClose; }
	&.mb-animate-exit-scale { animation-name: mbScaleOut; }
	&.mb-animate-exit-blur { animation-name: mbBlurOut; }

}

